<link rel="import" href="bower_components/note-app-elements/na-elements.html">
<link rel="import" href="bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="bower_components/polymerfire/polymerfire.html">
<link rel="import" href="bower_components/app-route/app-location.html">
<link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="bower_components/paper-item/paper-item.html">
<link rel="import" href="bower_components/paper-button/paper-button.html">
<link rel="import" href="bower_components/iron-pages/iron-pages.html">
<link rel="import" href="bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="components/home-view-element.html">
<link rel="import" href="components/event-element.html">

<dom-module id="travlendar-app">
    <template>
        <style include="note-app-shared-styles"></style>
        <style>
        .container {
            @apply(--layout-vertical);
            height: 90vh;
        }

        .flexchild {
            @apply(--layout-flex);
        }
        </style>

        <na-toolbar signed-in="[[signedIn]]" on-sign-out="signOut">
        </na-toolbar>

        <na-login on-sign-in="signIn" signed-in="[[signedIn]]" disabled="[[!online]]">
        </na-login>

        <firebase-auth id="auth" app-name="travlendar" provider="google" signed-in="{{signedIn}}" user="{{user}}">
        </firebase-auth>

        <na-editor id="editor" note="{{editableNote}}" on-close="commitChange">
        </na-editor>

        <firebase-document id="document" app-name="travlendar" path="[[editableNoteId]]" data="{{editableNote}}">
        </firebase-document>

        <firebase-query id="query" app-name="travlendar" path="/notes/[[user.uid]]" data="{{notes}}">
        </firebase-query>

        <app-indexeddb-mirror session="[[user.uid]]" key="notes" data="{{notes}}" persisted-data="{{persistedNotes}}">
        </app-indexeddb-mirror>

        <!-- <div class="notes">
            <template is="dom-repeat" items="[[persistedNotes]]" as="note">
                <na-note id$="[[note.$key]]" title="[[note.title]]" body="[[note.body]]" on-tap="edit">
                </na-note>
            </template>
        </div> -->

        <app-location route="{{route}}" use-hash-as-path></app-location>

        <home-view-element></home-view-element>

        <!--Main vertical layout-->
        <div class="container">
            <div class="flexchild">
                <!--Output Panel-->
                <!--Here we should have the Views components to show. Routing is centralized-->
                <iron-pages selected="[[route.path]]" attr-for-selected="key" fallback-selection="fallback">
                    <div key="foo">
                        <event-element></event-element>
                        <!--<h2>Output Panel 1 - ad esmpio ci pu√≤ andare</h2>-->
                    </div>
                    <div key="bar">
                        <h2>Output Panel 2!!</h2>
                    </div>
                    <div key="baz">
                        <h2>Output Panel 3</h2>
                    </div>
                    <div key="baz/sub">
                        <h2>this is a sub view</h2>
                    </div>
                    <div key="fallback">
                        Fallback page -> nothing matches significa. Sarebbe na home da mettere
                    </div>
                </iron-pages>
            </div>

            <div>
                <!--Text Panel-->
                <!--text here should should get the text from a view property-->
                <div>
                    <h3>Text Panel here</h3>
                    <br>
                    <br>
                    <br>Route (which can be used as breadcrumbs also with tabs): [[route.path]] </div>

                <paper-tabs selected='{{route.path}}' attr-for-selected='key'>
                    <paper-tab key='foo'>Foo</paper-tab>
                    <paper-tab key='bar'>Bar</paper-tab>
                    <paper-tab key='baz'>Baz!</paper-tab>
                </paper-tabs>
            </div>

            <div>
                <!--Input Panel-->

                <!-- the menu items depend on the view we're at. again theese data should be an array of data where data.link gives the link and data.name gives the name to display -->
                <iron-pages selected="[[route.path]]" attr-for-selected="key" fallback-selection="fallback">
                    <paper-menu key="foo">
                        <a href="#foo">
                            <paper-item>foo 1</paper-item>
                        </a>
                        <a href="#bar">
                            <paper-item>bar 1</paper-item>
                        </a>
                        <a href="#baz">
                            <paper-item>baz 1</paper-item>
                        </a>
                    </paper-menu>
                    <paper-menu key="bar">
                        <a href="#foo">
                            <paper-item>Item 5</paper-item>
                        </a>
                        <a href="#bar">
                            <paper-item>Item 6</paper-item>
                        </a>
                        <a href="#baz">
                            <paper-item>Item 7</paper-item>
                        </a>
                    </paper-menu>
                    <paper-menu key="fallback">
                        <a href="#foo">
                            <paper-item>aaaaaa</paper-item>
                        </a>
                        <a href="#bar">
                            <paper-item>bbbbb</paper-item>
                        </a>
                        <a href="#baz">
                            <paper-item>cccc</paper-item>
                        </a>
                    </paper-menu>
                </iron-pages>

                <!-- <paper-fab icon="add" on-tap="create" disabled="[[!online]]" aria-label="Add note">
                </paper-fab> -->
            </div>
        </div>

    </template>
    <script>
    Polymer({
        is: 'travlendar-app',
        behaviors: [Polymer.NoteAppBehavior],
        signIn: function() {
            this.$.auth.signInWithPopup();
        },
        get notesPath() {
            return '/notes/' + this.user.uid;
        },
        toEditableId: function(noteId) {
            return this.notesPath + '/' + noteId;
        },
        get isEditable() {
            return this.online;
        }
    });
    </script>
</dom-module>